@using HE.Investments.Common.WWW.Components.SelectList
@using HE.Investments.Common.WWW.Models
@using HE.Investments.FrontDoor.Contract.Site
@using HE.Investments.FrontDoor.WWW.Views.Shared.Components.FrontDoorWorkflowBackButton
@using HE.Investments.FrontDoor.WWW.Views.Site.Const
@using SelectList = Microsoft.AspNetCore.Mvc.Rendering.SelectList
@using HE.Investments.Common.Contract.Pagination
@using HE.Investments.Organisation.LocalAuthorities.ValueObjects;

@model (PaginationResult<LocalAuthority> Items, string ProjectId, string SiteId, string Phrase)

@{
    ViewData["Title"] = SitePageTitles.LocalAuthorityResult;

    var items = new PaginationResult<SelectListItemViewModel>(
        Model!.Items.Items.Select(i => new SelectListItemViewModel(
            Url.Action("LocalAuthorityConfirm", "Site", new { projectId = Model.ProjectId, siteId = Model.SiteId, localAuthorityId = i.Id }) ?? string.Empty,
            i.Name,
            null)).ToList(),
        Model.Items.CurrentPage,
        Model.Items.ItemsPerPage,
        Model.Items.TotalItems);
}

<gds-div-grid-column-two-thirds>
    <vc:front-door-workflow-back-button current-page="@SiteWorkflowState.LocalAuthorityResult"></vc:front-door-workflow-back-button>
    @await Html.PartialAsync("~/Partials/Errors/_ErrorSummaryPartial.cshtml")

    <vc:page-header title="@SitePageTitles.LocalAuthorityResult" caption="@ViewBag.ProjectName"/>

    <vc:select-list
        items="@items"
        paragraph-with-link="@(new ParagraphWithLinkModel("If you are not sure which local authority to choose, you can", new LinkModel("LocalAuthoritySearch", "Site", new { siteId = Model.SiteId, projectId = Model.ProjectId }), "search for the name of the local\nauthority using a postcode."))"
        paging-navigation-url="@Url.Action("LocalAuthorityResult", "Site", new { siteId = Model.SiteId, phrase = Model.Phrase })"/>

</gds-div-grid-column-two-thirds>
