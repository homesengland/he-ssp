function TimeoutWarning(n){(this.$module=n,n)&&(this.$lastFocusedEl=null,this.$closeButton=n.querySelector(".js-dialog-close"),this.$cancelButton=n.querySelector(".js-dialog-cancel"),this.overLayClass="govuk-timeout-warning-overlay",this.timers=[],this.$countdown=n.querySelector(".timer"),this.$accessibleCountdown=n.querySelector(".at-timer"),this.minutesTimeOutModalVisible=n.getAttribute("data-minutes-modal-visible")*1,this.idleMinutesBeforeTimeOut=n.getAttribute("data-minutes-idle-timeout")*1-this.minutesTimeOutModalVisible,this.timeOutRedirectUrl=n.getAttribute("data-url-redirect"),this.timeUserLastInteractedWithPage="",this.keepAliveUrl=n.getAttribute("data-keep-alive-url"),this.isOverrideTimeoutBackButton=n.getAttribute("data-is-override-timeout-back-button")==="true",this.overrideTimeoutBackButtonUrl=n.getAttribute("data-override-timeout-back-button-url"))}TimeoutWarning.prototype.init=function(){this.$module&&this.dialogSupported()&&(this.bypassTimeout()||(this.countIdleTime(),this.$closeButton.addEventListener("click",this.closeDialog.bind(this)),this.$module.addEventListener("keydown",this.escClose.bind(this)),window.addEventListener("focus",this.checkIfShouldHaveTimedOut.bind(this))))};TimeoutWarning.prototype.getQuerystringParamValue=function(n){for(var i,u=window.location.search.substring(1),r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]===n)return i[1];return""};TimeoutWarning.prototype.dialogSupported=function(){if(typeof HTMLDialogElement=="function")return!0;try{return window.dialogPolyfill.registerDialog(this.$module),!0}catch(n){return!1}};TimeoutWarning.prototype.bypassTimeout=function(){return document.getElementById("bypass-timeout")!==null?!0:!1};TimeoutWarning.prototype.countIdleTime=function(){var n=Number(this.getQuerystringParamValue("sessiontimeout")),t;n>0&&(this.idleMinutesBeforeTimeOut=n);t=this.idleMinutesBeforeTimeOut*6e4;setTimeout(this.openDialog.bind(this),t);window.localStorage&&window.localStorage.setItem("timeUserLastInteractedWithPage",new Date)};TimeoutWarning.prototype.openDialog=function(){this.isDialogOpen()||(document.querySelector("body").classList.add(this.overLayClass),document.getElementById("js-timeout-warning").classList.add("dialog-open"),this.saveLastFocusedEl(),this.makePageContentInert(),this.$module.showModal(),this.startUiCountdown())};TimeoutWarning.prototype.startUiCountdown=function(){this.clearTimers();var u=this,t=this.$countdown,n=this.$accessibleCountdown,i=this.minutesTimeOutModalVisible,f=!1,e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,o=this.timers,r=60*i;t.innerHTML=i+" minute"+(i>1?"s":""),function s(){var i=parseInt(r/60,10),h=parseInt(r%60,10),p=i<1&&h<1,w=i>0?'<span class="tabular-numbers">'+i+"<\/span> minute"+(i>1?"s":"")+"":" ",b=h>=1?' <span class="tabular-numbers">'+h+"<\/span> second"+(h>1?"s":"")+"":"",l="",a="",v;try{l=this.numberToWords(i);a=this.numberToWords(h)}catch(g){l=i;a=h}var k=i>0?l+" minute"+(i>1?"s":"")+"":"",y=h>=1?" "+a+" second"+(h>1?"s":"")+"":"",d="Your application will be reset if you do not respond in "+w+b+".",c="Your application will be reset if you do not respond in "+k;y?(i>0&&(c+=" and"),c+=y+"."):c+=".";v=" This keeps your information secure.";p?(t.innerHTML="You are about to be redirected",n.innerHTML="You are about to be redirected",setTimeout(u.redirect.bind(u),4e3)):(r--,t.innerHTML=d+v,i<1&&h<20&&n.setAttribute("aria-live","assertive"),f?h%15==0&&(n.innerHTML=c):(n.innerHTML=e?c:c+v,f=!0),o.push(setTimeout(s,1e3)))}()};TimeoutWarning.prototype.saveLastFocusedEl=function(){this.$lastFocusedEl=document.activeElement;this.$lastFocusedEl&&this.$lastFocusedEl!==document.body?document.querySelector&&(this.$lastFocusedEl=document.querySelector(":focus")):this.$lastFocusedEl=null};TimeoutWarning.prototype.setFocusOnLastFocusedEl=function(){this.$lastFocusedEl&&window.setTimeout(function(){this.$lastFocusedEl&&this.$lastFocusedEl.focus()},0)};TimeoutWarning.prototype.makePageContentInert=function(){document.querySelector("#content")&&(document.querySelector("#content").inert=!0,document.querySelector("#content").setAttribute("aria-hidden","true"))};TimeoutWarning.prototype.removeInertFromPageContent=function(){document.querySelector("#content")&&(document.querySelector("#content").inert=!1,document.querySelector("#content").setAttribute("aria-hidden","false"))};TimeoutWarning.prototype.isDialogOpen=function(){return this.$module.open};TimeoutWarning.prototype.closeDialog=function(){this.isDialogOpen()&&(this.performKeepAlive(),document.querySelector("body").classList.remove(this.overLayClass),document.getElementById("js-timeout-warning").classList.remove("dialog-open"),this.$module.close(),this.setFocusOnLastFocusedEl(),this.removeInertFromPageContent(),this.clearTimers(),this.countIdleTime())};TimeoutWarning.prototype.clearTimers=function(){for(var n=0;n<this.timers.length;n++)clearTimeout(this.timers[n])};TimeoutWarning.prototype.disableBackButtonWhenOpen=function(){window.addEventListener("popstate",function(){this.isDialogOpen()?this.closeDialog():window.history.go(-1)})};TimeoutWarning.prototype.escClose=function(n){this.isDialogOpen()&&n.keyCode===27&&this.closeDialog()};TimeoutWarning.prototype.checkIfShouldHaveTimedOut=function(){if(window.localStorage){var n=new Date(window.localStorage.getItem("timeUserLastInteractedWithPage")),t=Math.abs((n-new Date)/1e3);t>this.idleMinutesBeforeTimeOut*60+this.minutesTimeOutModalVisible*60&&this.redirect.bind(this)()}};TimeoutWarning.prototype.performKeepAlive=function(){var n=new XMLHttpRequest,t=this.keepAliveUrl;n.open("GET",t,!0);n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var t=n.status;t===0||t>=200&&t<400?window.localStorage&&window.localStorage.setItem("timeUserLastInteractedWithPage",new Date):console.error(n.responseText)}};n.send()};TimeoutWarning.prototype.redirect=function(){this.isOverrideTimeoutBackButton===!0&&history.pushState(null,null,this.overrideTimeoutBackButtonUrl);window.location.href=this.timeOutRedirectUrl};TimeoutWarning.prototype.numberToWords=function(){var o=n.toString(),s,l,h,f,a,e,c,v,i,r,t,u="and";if(parseInt(o)===0)return"zero";for(s=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],l=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],h=["","thousand","million","billion","trillion","quadrillion","quintillion","sextillion","septillion","octillion","nonillion","decillion","undecillion","duodecillion","tredecillion","quatttuor-decillion","quindecillion","sexdecillion","septen-decillion","octodecillion","novemdecillion","vigintillion","centillion"],f=o.length,e=[];f>0;)a=f,e.push(o.slice(f=Math.max(0,f-3),a));if(c=e.length,c>h.length)return"";for(u=[],r=0;r<c;r++)v=parseInt(e[r]),v&&(i=e[r].split("").reverse().map(parseFloat),i[1]===1&&(i[0]+=10),(t=h[r])&&u.push(t),(t=s[i[0]])&&u.push(t),(t=l[i[1]])&&u.push(t),(t=s[i[2]])&&u.push(t+" hundred"));return u.reverse().join(" ")};var $timeoutWarning=document.querySelector('[data-module="govuk-timeout-warning"]');new TimeoutWarning($timeoutWarning).init(),function(){var n=function(){"use strict";function i(){n!==null&&n.addEventListener("click",function(){t.classList.add("u-hide")},!1)}var t=document.getElementById("cookie-message"),n=document.getElementById("jsHideLink");return{hideBanner:function(){i()}}}();n.hideBanner()}();