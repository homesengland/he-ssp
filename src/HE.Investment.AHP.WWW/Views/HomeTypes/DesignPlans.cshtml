@using HE.Investment.AHP.Domain.HomeTypes
@using HE.Investment.AHP.WWW.Extensions
@model HE.Investment.AHP.WWW.Models.HomeTypes.DesignPlansModel;

@{
    var applicationId = this.GetApplicationIdFromRoute();
    var homeTypeId = this.GetHomeTypeIdFromRoute();
    var workflow = Context.Request.Query["workflow"];
}

<div class="govuk-grid-column-full">
    <form asp-controller="HomeTypes" asp-action="DesignPlans" asp-method="post" enctype="multipart/form-data" asp-route-workflow="@workflow" novalidate>
        <vc:home-type-form-header title="Upload your design plans"
                                  current-page="@HomeTypesWorkflowState.DesignPlans"
                                  application-id="@applicationId"
                                  home-type-id="@homeTypeId"
                                  caption="@Model.Header"/>

        @Html.HiddenFor(m => Model.ApplicationName)
        @Html.HiddenFor(m => Model.HomeTypeName)
        @Html.HiddenFor(x => x.AllowedExtensions)
        @Html.HiddenFor(x => x.MaxFileSizeInMegabytes)

        <vc:upload-file field-name="File"
                        description="Upload all relevant files."
                        allowed-extensions="@Model.AllowedExtensions"
                        is-multiple="true"
                        max-file-size-in-mb="@Model.MaxFileSizeInMegabytes"
                        upload-one-file-url="@Url.Action("UploadDesignPlansFile", "HomeTypes", new { applicationId, homeTypeId })"
                        remove-file-url-template="@Url.Action("RemoveDesignPlansFile", "HomeTypes", new { applicationId, homeTypeId, workflow, fileId = ":fileId" })"
                        download-file-url-template="@Url.Action("DownloadDesignPlansFile", "HomeTypes", new { applicationId, homeTypeId, fileId = ":fileId" })"/>

        <vc:files-table asp-for="@Model.UploadedFiles"/>

        <div class="govuk-grid-column-two-thirds govuk-!-padding-left-0">
            <vc:text-area-input-with-counter
                field-name="@nameof(Model.MoreInformation)"
                title="Tell us more about your design plans (optional)"
                hint="Tell us any important information about the plans, or any additional information not included."
                value="@Model.MoreInformation"/>
        </div>

        <div class="govuk-grid-column-two-thirds govuk-!-padding-left-0">
            <vc:form-button/>
            <br/>
            <vc:return-to-application-link application-id="@applicationId"/>
        </div>
    </form>
</div>
