@using HE.Investment.AHP.WWW.Views.Delivery.Const
@using HE.Investment.AHP.WWW.Views.Shared.Components.AhpWorkflowBackButton
@using HE.Investment.AHP.Contract.Delivery
@using HE.Investment.AHP.WWW.Extensions
@using HE.Investment.AHP.WWW.Models.Delivery
@using HE.Investments.Common.WWW.Components.FormHeader
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model SummaryOfDeliveryTrancheModel;
@{
    var applicationId = this.GetApplicationIdFromRoute();
    string title = string.Empty;
    string description = string.Empty;

    switch (Model.TrancheType)
    {
        case SummaryOfDeliveryTrancheType.Acquisition:
        {
            title = DeliveryPageTitles.AcquisitionTranche;
            description = DeliveryPhaseDescriptions.AcquisitionTranche;
            break;
        }
        case SummaryOfDeliveryTrancheType.StartOnSite:
        {
            title = DeliveryPageTitles.StartOnSiteTranche;
            description = DeliveryPhaseDescriptions.StartOnSiteTranche;
            break;
        }
        case SummaryOfDeliveryTrancheType.Completion:
        {
            title = DeliveryPageTitles.CompletionTranche;
            description = DeliveryPhaseDescriptions.CompletionTranche;
            break;
        }
    }

    ViewData["Title"] = title;
}

<gds-div-grid-column-two-thirds>
    <vc:ahp-workflow-back-button current-page="@DeliveryPhaseWorkflowState.SummaryOfDeliveryTranche"/>

    @await Html.PartialAsync("~/Partials/Errors/_ErrorSummaryPartial.cshtml")

    <form asp-controller="DeliveryPhase" asp-action="SummaryOfDeliveryTranche" asp-method="post" asp-route-applicationId="@applicationId" asp-route-deliveryPhaseId="@Model.DeliveryPhaseId" asp-route-redirect="@Context.Request.Query["redirect"]" novalidate>
        <vc:form-header caption="@($"{Model.ApplicationName} - {Model.DeliveryPhaseName}")" title="@title" hint="@description"/>

        @Html.HiddenFor(x => x.TrancheType)
        <vc:numeric-text-input field-name="@nameof(Model.Value)"
                               value="@Model.Value.ToString()"
                               hint="Amount of grant apportioned to this phase"
                               prefix="Â£"
                               css-class="govuk-input--width-10"/>

        <vc:form-button/>

        <vc:return-to-application-link application-id="@applicationId"/>
    </form>
</gds-div-grid-column-two-thirds>
